/**
 * üéÆ –ö–ª–∞—Å Tank - –±–∞–∑–æ–≤–∏–π –∫–ª–∞—Å –¥–ª—è –≤—Å—ñ—Ö —Ç–∞–Ω–∫—ñ–≤
 *
 * –í—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞:
 * - –ë–∞–∑–æ–≤—É –ª–æ–≥—ñ–∫—É —Ç–∞–Ω–∫–∞ (—è–∫ –ø—Ä–∞–≤–∏–ª–∞ –≥—Ä–∏!)
 * - –ú–∞–ª—é–≤–∞–Ω–Ω—è —Ç–∞–Ω–∫–∞ (—è–∫ –º–∞–ª—é–≤–∞—Ç–∏ –º–∞—à–∏–Ω–∫—É!)
 * - –§—ñ–∑–∏–∫—É —Ä—É—Ö—É (—è–∫ —Ä—É—Ö–∞—î—Ç—å—Å—è –º–∞—à–∏–Ω–∫–∞!)
 */

export class Tank {
  constructor(options = {}) {
    // –ü–æ–∑–∏—Ü—ñ—è —Ç–∞–Ω–∫–∞ –Ω–∞ –ø–æ–ª—ñ (—è–∫ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ –Ω–∞ –∫–∞—Ä—Ç—ñ!)
    // –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ X (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º 0)
    this.x = options.x || 0;
    // –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ Y (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º 0)
    this.y = options.y || 0;

    // –†–æ–∑–º—ñ—Ä–∏ —Ç–∞–Ω–∫–∞ (—è–∫ —Ä–æ–∑–º—ñ—Ä –º–∞—à–∏–Ω–∫–∏!)
    // —à–∏—Ä–∏–Ω–∞ —Ç–∞–Ω–∫–∞ –≤ –ø—ñ–∫—Å–µ–ª—è—Ö
    this.width = options.size || 32;
    // –≤–∏—Å–æ—Ç–∞ —Ç–∞–Ω–∫–∞ –≤ –ø—ñ–∫—Å–µ–ª—è—Ö
    this.height = options.size || 32;

    // –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ —Ç–∞–Ω–∫–∞ (—è–∫ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –º–∞—à–∏–Ω–∫–∏!)
    // –∫–æ–ª—ñ—Ä —Ç–∞–Ω–∫–∞ (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –±—ñ–ª–∏–π)
    this.color = options.color || '#ffffff';
    // —à–≤–∏–¥–∫—ñ—Å—Ç—å —Ä—É—Ö—É —Ç–∞–Ω–∫–∞ (—è–∫ —à–≤–∏–¥–∫—ñ—Å—Ç—å –º–∞—à–∏–Ω–∫–∏!)
    this.speed = options.speed || 1;
    // –Ω–∞–ø—Ä—è–º–æ–∫ –¥—É–ª–∞ —Ç–∞–Ω–∫–∞ (–∫—É–¥–∏ –¥–∏–≤–∏—Ç—å—Å—è –¥—É–ª–æ!)
    this.direction = options.direction || 'up';

    // –°—Ç–∞–Ω —Ç–∞–Ω–∫–∞ (—è–∫ —Å—Ç–∞–Ω –º–∞—à–∏–Ω–∫–∏!)
    // —á–∏ –∂–∏–≤–∏–π —Ç–∞–Ω–∫
    this.isAlive = true;
    // –∑–¥–æ—Ä–æ–≤'—è —Ç–∞–Ω–∫–∞ (–≤—ñ–¥ 0 –¥–æ 100, —è–∫ –∑–¥–æ—Ä–æ–≤'—è –ª—é–¥–∏–Ω–∏!)
    this.health = 100;
  }

  /**
   * –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞–Ω—É —Ç–∞–Ω–∫–∞ (—è–∫ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ —Å—Ç–∞–Ω –º–∞—à–∏–Ω–∫–∏!)
   * @param {number} deltaTime - –ß–∞—Å –∑ –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
   */
  update(deltaTime) {
    // –ë–∞–∑–æ–≤–∞ –ª–æ–≥—ñ–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è (–ø–æ–∫–∏ —â–æ –ø–æ—Ä–æ–∂–Ω—è)
    // –í –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö —É—Ä–æ–∫–∞—Ö —Ç—É—Ç –±—É–¥–µ –ª–æ–≥—ñ–∫–∞ —Ä—É—Ö—É —Ç–∞ —Å—Ç—Ä—ñ–ª—å–±–∏
  }

  /**
   * –ú–∞–ª—é–≤–∞–Ω–Ω—è —Ç–∞–Ω–∫–∞ (—è–∫ –º–∞–ª—é–≤–∞—Ç–∏ –º–∞—à–∏–Ω–∫—É –Ω–∞ –ø–∞–ø–µ—Ä—ñ!)
   * @param {CanvasRenderingContext2D} ctx - –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –º–∞–ª—é–≤–∞–Ω–Ω—è
   */
  render(ctx) {
    // —è–∫—â–æ —Ç–∞–Ω–∫ –º–µ—Ä—Ç–≤–∏–π, –Ω–µ –º–∞–ª—é—î–º–æ –π–æ–≥–æ (—è–∫ –Ω–µ –º–∞–ª—é–≤–∞—Ç–∏ –∑–ª–∞–º–∞–Ω—É –º–∞—à–∏–Ω–∫—É!)
    if (!this.isAlive) return;

    // –ú–∞–ª—é—î–º–æ —Ç—ñ–ª–æ —Ç–∞–Ω–∫–∞ (–æ—Å–Ω–æ–≤–Ω–∏–π –ø—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫ - —è–∫ –∫—É–∑–æ–≤ –º–∞—à–∏–Ω–∫–∏!)
    // –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –∫–æ–ª—ñ—Ä —Ç–∞–Ω–∫–∞
    ctx.fillStyle = this.color;
    // –º–∞–ª—é—î–º–æ –ø—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫
    ctx.fillRect(this.x, this.y, this.width, this.height);

    // –ú–∞–ª—é—î–º–æ –¥—É–ª–æ —Ç–∞–Ω–∫–∞ (–¥–æ–¥–∞—Ç–∫–æ–≤–∏–π –µ–ª–µ–º–µ–Ω—Ç - —è–∫ —Ç—Ä—É–±–∞ –º–∞—à–∏–Ω–∫–∏!)
    // –≤–∏–∫–ª–∏–∫–∞—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é –º–∞–ª—é–≤–∞–Ω–Ω—è –¥—É–ª–∞
    this.drawBarrel(ctx);
  }

  /**
   * –ú–∞–ª—é–≤–∞–Ω–Ω—è –¥—É–ª–∞ —Ç–∞–Ω–∫–∞ (—è–∫ –º–∞–ª—é–≤–∞—Ç–∏ —Ç—Ä—É–±—É –º–∞—à–∏–Ω–∫–∏!)
   * @param {CanvasRenderingContext2D} ctx - –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –º–∞–ª—é–≤–∞–Ω–Ω—è
   */
  drawBarrel(ctx) {
    // –¥–æ–≤–∂–∏–Ω–∞ –¥—É–ª–∞ (60% –≤—ñ–¥ —à–∏—Ä–∏–Ω–∏ —Ç–∞–Ω–∫–∞ - —è–∫ –¥–æ–≤–≥–∞ —Ç—Ä—É–±–∞!)
    const barrelLength = this.width * 0.6;
    // —à–∏—Ä–∏–Ω–∞ –¥—É–ª–∞ (20% –≤—ñ–¥ —à–∏—Ä–∏–Ω–∏ —Ç–∞–Ω–∫–∞ - —è–∫ —Ç–æ–Ω–∫–∞ —Ç—Ä—É–±–∞!)
    const barrelWidth = this.width * 0.2;

    // —Ç–µ–º–Ω–æ-—Å–∏–Ω—ñ–π –∫–æ–ª—ñ—Ä –¥–ª—è –¥—É–ª–∞ (—è–∫ –∫–æ–ª—ñ—Ä –º–µ—Ç–∞–ª—É!)
    ctx.fillStyle = '#2c3e50';

    // –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –Ω–∞–ø—Ä—è–º–æ–∫ –¥—É–ª–∞ (–∫—É–¥–∏ –¥–∏–≤–∏—Ç—å—Å—è —Ç—Ä—É–±–∞!)
    switch (this.direction) {
      // —è–∫—â–æ –¥—É–ª–æ –¥–∏–≤–∏—Ç—å—Å—è –≤–≥–æ—Ä—É (—è–∫ —Ç—Ä—É–±–∞ –¥–∏–≤–∏—Ç—å—Å—è –≤ –Ω–µ–±–æ!)
      case 'up':
        ctx.fillRect(
          // —Ü–µ–Ω—Ç—Ä—É—î–º–æ –¥—É–ª–æ –ø–æ X (—Ä–æ–∑–º—ñ—â—É—î–º–æ –ø–æ —Ü–µ–Ω—Ç—Ä—É!)
          this.x + this.width / 2 - barrelWidth / 2,
          // —Ä–æ–∑–º—ñ—â—É—î–º–æ –¥—É–ª–æ –≤–∏—â–µ —Ç–∞–Ω–∫–∞ (–Ω–∞–¥ –º–∞—à–∏–Ω–∫–æ—é!)
          this.y - barrelLength,
          // —à–∏—Ä–∏–Ω–∞ –¥—É–ª–∞
          barrelWidth,
          // –¥–æ–≤–∂–∏–Ω–∞ –¥—É–ª–∞
          barrelLength
        );
        break;
      // —è–∫—â–æ –¥—É–ª–æ –¥–∏–≤–∏—Ç—å—Å—è –≤–Ω–∏–∑ (—è–∫ —Ç—Ä—É–±–∞ –¥–∏–≤–∏—Ç—å—Å—è –≤ –∑–µ–º–ª—é!)
      case 'down':
        ctx.fillRect(
          // —Ü–µ–Ω—Ç—Ä—É—î–º–æ –¥—É–ª–æ –ø–æ X (—Ä–æ–∑–º—ñ—â—É—î–º–æ –ø–æ —Ü–µ–Ω—Ç—Ä—É!)
          this.x + this.width / 2 - barrelWidth / 2,
          // —Ä–æ–∑–º—ñ—â—É—î–º–æ –¥—É–ª–æ –Ω–∏–∂—á–µ —Ç–∞–Ω–∫–∞ (–ø—ñ–¥ –º–∞—à–∏–Ω–∫–æ—é!)
          this.y + this.height,
          // —à–∏—Ä–∏–Ω–∞ –¥—É–ª–∞
          barrelWidth,
          // –¥–æ–≤–∂–∏–Ω–∞ –¥—É–ª–∞
          barrelLength
        );
        break;
      // —è–∫—â–æ –¥—É–ª–æ –¥–∏–≤–∏—Ç—å—Å—è –≤–ª—ñ–≤–æ (—è–∫ —Ç—Ä—É–±–∞ –¥–∏–≤–∏—Ç—å—Å—è –≤–ª—ñ–≤–æ!)
      case 'left':
        ctx.fillRect(
          // —Ä–æ–∑–º—ñ—â—É—î–º–æ –¥—É–ª–æ –ª—ñ–≤—ñ—à–µ —Ç–∞–Ω–∫–∞ (–∑–ª—ñ–≤–∞ –≤—ñ–¥ –º–∞—à–∏–Ω–∫–∏!)
          this.x - barrelLength,
          // —Ü–µ–Ω—Ç—Ä—É—î–º–æ –¥—É–ª–æ –ø–æ Y (—Ä–æ–∑–º—ñ—â—É—î–º–æ –ø–æ —Ü–µ–Ω—Ç—Ä—É!)
          this.y + this.height / 2 - barrelWidth / 2,
          // –¥–æ–≤–∂–∏–Ω–∞ –¥—É–ª–∞
          barrelLength,
          // —à–∏—Ä–∏–Ω–∞ –¥—É–ª–∞
          barrelWidth
        );
        break;
      // —è–∫—â–æ –¥—É–ª–æ –¥–∏–≤–∏—Ç—å—Å—è –≤–ø—Ä–∞–≤–æ (—è–∫ —Ç—Ä—É–±–∞ –¥–∏–≤–∏—Ç—å—Å—è –≤–ø—Ä–∞–≤–æ!)
      case 'right':
        ctx.fillRect(
          // —Ä–æ–∑–º—ñ—â—É—î–º–æ –¥—É–ª–æ –ø—Ä–∞–≤—ñ—à–µ —Ç–∞–Ω–∫–∞ (—Å–ø—Ä–∞–≤–∞ –≤—ñ–¥ –º–∞—à–∏–Ω–∫–∏!)
          this.x + this.width,
          // —Ü–µ–Ω—Ç—Ä—É—î–º–æ –¥—É–ª–æ –ø–æ Y (—Ä–æ–∑–º—ñ—â—É—î–º–æ –ø–æ —Ü–µ–Ω—Ç—Ä—É!)
          this.y + this.height / 2 - barrelWidth / 2,
          // –¥–æ–≤–∂–∏–Ω–∞ –¥—É–ª–∞
          barrelLength,
          // —à–∏—Ä–∏–Ω–∞ –¥—É–ª–∞
          barrelWidth
        );
        break;
    }
  }

  /**
   * –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ —Ç–∞–Ω–∫ –∂–∏–≤–∏–π (—è–∫ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –ø—Ä–∞—Ü—é—î –º–∞—à–∏–Ω–∫–∞!)
   * @returns {boolean} - true —è–∫—â–æ —Ç–∞–Ω–∫ –∂–∏–≤–∏–π
   */
  isTankAlive() {
    // —Ç–∞–Ω–∫ –∂–∏–≤–∏–π —è–∫—â–æ isAlive=true —ñ –∑–¥–æ—Ä–æ–≤'—è > 0 (—è–∫ –º–∞—à–∏–Ω–∫–∞ –ø—Ä–∞—Ü—é—î!)
    return this.isAlive && this.health > 0;
  }

  /**
   * –í–±–∏—Ç–∏ —Ç–∞–Ω–∫ (—è–∫ –∑–ª–∞–º–∞—Ç–∏ –º–∞—à–∏–Ω–∫—É!)
   */
  kill() {
    // –ø–æ–∑–Ω–∞—á–∞—î–º–æ —Ç–∞–Ω–∫ —è–∫ –º–µ—Ä—Ç–≤–∏–π
    this.isAlive = false;
    // –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –∑–¥–æ—Ä–æ–≤'—è –≤ 0
    this.health = 0;
  }

  /**
   * –í—ñ–¥—Ä–æ–¥–∏—Ç–∏ —Ç–∞–Ω–∫ (—è–∫ –ø–æ—á–∏–Ω–∏—Ç–∏ –º–∞—à–∏–Ω–∫—É!)
   */
  respawn() {
    // –ø–æ–∑–Ω–∞—á–∞—î–º–æ —Ç–∞–Ω–∫ —è–∫ –∂–∏–≤–∏–π
    this.isAlive = true;
    // –≤—ñ–¥–Ω–æ–≤–ª—é—î–º–æ –ø–æ–≤–Ω–µ –∑–¥–æ—Ä–æ–≤'—è
    this.health = 100;
  }
}
