/**
 * üéÆ –¢–∞–Ω—á–∏–∫–∏ - –£—Ä–æ–∫ 2: –ú–∞–ª—é–≤–∞–Ω–Ω—è –ø–æ–ª—è —Ç–∞ —Ç–∞–Ω–∫—ñ–≤
 * 
 * –£ —Ü—å–æ–º—É —Ñ–∞–π–ª—ñ –º–∏ –∑–∞–ø—É—Å–∫–∞—î–º–æ –≥—Ä—É –∑:
 * - –Ü–≥—Ä–æ–≤–∏–º –ø–æ–ª–µ–º —Ç–∞ —Å—ñ—Ç–∫–æ—é
 * - –¢–∞–Ω–∫–æ–º –≥—Ä–∞–≤—Ü—è (–∂–æ–≤—Ç–∏–π –∫–≤–∞–¥—Ä–∞—Ç)
 * - –í–æ—Ä–æ–∂–∏–º —Ç–∞–Ω–∫–æ–º (—á–µ—Ä–≤–æ–Ω–∏–π –∫–≤–∞–¥—Ä–∞—Ç)
 * - –°—Ç—ñ–Ω–∞–º–∏ —Ç–∞ –ø–µ—Ä–µ—à–∫–æ–¥–∞–º–∏
 */

// –û—Ç—Ä–∏–º—É—î–º–æ Canvas –µ–ª–µ–º–µ–Ω—Ç –∑ HTML
// –∑–Ω–∞—Ö–æ–¥–∏–º–æ Canvas –ø–æ ID
const canvas = document.getElementById('gameCanvas');

// –û—Ç—Ä–∏–º—É—î–º–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –º–∞–ª—é–≤–∞–Ω–Ω—è (2D)
// –æ—Ç—Ä–∏–º—É—î–º–æ 2D –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –º–∞–ª—é–≤–∞–Ω–Ω—è
const ctx = canvas.getContext('2d');

// –ë–∞–∑–æ–≤—ñ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∏ –≥—Ä–∏
const GAME_CONFIG = {
    // —à–∏—Ä–∏–Ω–∞ Canvas –≤ –ø—ñ–∫—Å–µ–ª—è—Ö
    CANVAS_WIDTH: 800,
    // –≤–∏—Å–æ—Ç–∞ Canvas –≤ –ø—ñ–∫—Å–µ–ª—è—Ö
    CANVAS_HEIGHT: 600,
    // —Ä–æ–∑–º—ñ—Ä –æ–¥–Ω—ñ—î—ó –∫–ª—ñ—Ç–∏–Ω–∫–∏ –≤ –ø—ñ–∫—Å–µ–ª—è—Ö
    TILE_SIZE: 32,
    // –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–∞–¥—Ä—ñ–≤ –∑–∞ —Å–µ–∫—É–Ω–¥—É
    FPS: 60
};

// –Ü–º–ø–æ—Ä—Ç—É—î–º–æ –∫–ª–∞—Å–∏
// —ñ–º–ø–æ—Ä—Ç—É—î–º–æ –≥–æ–ª–æ–≤–Ω–∏–π –∫–ª–∞—Å –≥—Ä–∏
import { Game } from './Game.js';
// —ñ–º–ø–æ—Ä—Ç—É—î–º–æ –∫–ª–∞—Å –ª–æ–≥—É–≤–∞–Ω–Ω—è
import { GameLogger } from './GameLogger.js';

// –°—Ç–≤–æ—Ä—é—î–º–æ –µ–∫–∑–µ–º–ø–ª—è—Ä–∏
// –µ–∫–∑–µ–º–ø–ª—è—Ä –≥—Ä–∏ (–ø–æ–∫–∏ —â–æ –Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π)
let game;
// –µ–∫–∑–µ–º–ø–ª—è—Ä –ª–æ–≥–µ—Ä–∞ (–ø–æ–∫–∏ —â–æ –Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π)
let logger;

/**
 * –§—É–Ω–∫—Ü—ñ—è —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó –≥—Ä–∏
 * –í–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É
 */
function initGame() {
    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ –ª–æ–≥–µ—Ä
    // —Å—Ç–≤–æ—Ä—é—î–º–æ –Ω–æ–≤–∏–π –µ–∫–∑–µ–º–ø–ª—è—Ä –ª–æ–≥–µ—Ä–∞
    logger = new GameLogger();
    
    // –∑–∞–ø–∏—Å—É—î–º–æ –ø–æ—á–∞—Ç–æ–∫ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó
    logger.gameEvent('–Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –≥—Ä–∏ "–¢–∞–Ω—á–∏–∫–∏" - –£—Ä–æ–∫ 2');
    // —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ä–æ–∑–º—ñ—Ä–∏
    logger.info(`üìê –†–æ–∑–º—ñ—Ä Canvas: ${GAME_CONFIG.CANVAS_WIDTH} x ${GAME_CONFIG.CANVAS_HEIGHT}`);
    // —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫–ª—ñ—Ç–∏–Ω–∫–∏
    logger.info(`üî≤ –†–æ–∑–º—ñ—Ä –∫–ª—ñ—Ç–∏–Ω–∫–∏: ${GAME_CONFIG.TILE_SIZE} –ø—ñ–∫—Å–µ–ª—ñ–≤`);
    
    // –°—Ç–≤–æ—Ä—é—î–º–æ –Ω–æ–≤—É –≥—Ä—É
    // —Å—Ç–≤–æ—Ä—é—î–º–æ –Ω–æ–≤–∏–π –µ–∫–∑–µ–º–ø–ª—è—Ä –≥—Ä–∏
    game = new Game(logger);
    
    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ –≥—Ä—É
    // —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ –≤—Å—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –≥—Ä–∏
    game.init();
    
    // –ó–∞–ø—É—Å–∫–∞—î–º–æ –≥—Ä—É
    // –∑–∞–ø—É—Å–∫–∞—î–º–æ —ñ–≥—Ä–æ–≤–∏–π —Ü–∏–∫–ª
    game.start();
    
    // –∑–∞–ø–∏—Å—É—î–º–æ —É—Å–ø—ñ—à–Ω–∏–π –∑–∞–ø—É—Å–∫
    logger.success('–ì—Ä–∞ –∑–∞–ø—É—â–µ–Ω–∞ —É—Å–ø—ñ—à–Ω–æ!');
}

// –ó–∞–ø—É—Å–∫–∞—î–º–æ –≥—Ä—É –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏
document.addEventListener('DOMContentLoaded', () => {
    // –≤–∏–∫–ª–∏–∫–∞—î–º–æ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—é –≥—Ä–∏
    initGame();
});

// –§—É–Ω–∫—Ü—ñ—è –æ—á–∏—â–µ–Ω–Ω—è –ª–æ–≥—É
function clearLog() {
    // –∑–Ω–∞—Ö–æ–¥–∏–º–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ª–æ–≥—É
    const logContent = document.getElementById('logContent');
    // –æ—á–∏—â–∞—î–º–æ –≤–µ—Å—å –≤–º—ñ—Å—Ç
    logContent.innerHTML = '';
}

// –ï–∫—Å–ø–æ—Ä—Ç—É—î–º–æ –æ—Å–Ω–æ–≤–Ω—ñ –∑–º—ñ–Ω–Ω—ñ –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ —ñ–Ω—à–∏—Ö —Ñ–∞–π–ª–∞—Ö
// –µ–∫—Å–ø–æ—Ä—Ç—É—î–º–æ –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ —ñ–Ω—à–∏—Ö –º–æ–¥—É–ª—è—Ö
export { canvas, ctx, GAME_CONFIG, logger };