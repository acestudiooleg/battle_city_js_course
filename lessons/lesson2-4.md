# 2.4: –°—Ç–≤–æ—Ä—é—î–º–æ —Ç–∞–Ω–∫ –≤–æ—Ä–æ–≥–∞! üëπ

## –©–æ –º–∏ –±—É–¥–µ–º–æ —Ä–æ–±–∏—Ç–∏ —Å—å–æ–≥–æ–¥–Ω—ñ? üöÄ

–£ —Ü—å–æ–º—É —É—Ä–æ—Ü—ñ –º–∏ —Å—Ç–≤–æ—Ä–∏–º–æ –∫–ª–∞—Å `Enemy.js`, —è–∫–∏–π —É—Å–ø–∞–¥–∫–æ–≤—É–≤–∞—Ç–∏–º–µ –≤—ñ–¥ –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—É —Ç–∞–Ω–∫–∞ —Ç–∞ –¥–æ–¥–∞—Å—Ç—å —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—É –ª–æ–≥—ñ–∫—É –¥–ª—è –≤–æ—Ä–æ–∂–æ–≥–æ —Ç–∞–Ω–∫–∞.

<img src="/battle_city_js_course/enemy.png" />

## üé® –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–ª–∞—Å—É Enemy.js

–°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª `Enemy.js`:

```javascript
import { Tank } from './Tank.js';
import { red, darkGray } from './colors.js';

/**
 * üéÆ –ö–ª–∞—Å Enemy - –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î –≤–æ—Ä–æ–∂–æ–≥–æ —Ç–∞–Ω–∫–∞
 * 
 * –í—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞:
 * - –õ–æ–≥—ñ–∫—É –≤–æ—Ä–æ–∂–æ–≥–æ —Ç–∞–Ω–∫–∞
 * - –®—Ç—É—á–Ω–∏–π —ñ–Ω—Ç–µ–ª–µ–∫—Ç
 */

export class Enemy extends Tank {
    constructor(options = {}, logger) {
        // –í–∏–∫–ª–∏–∫–∞—î–º–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–æ–≥–æ –∫–ª–∞—Å—É Tank
        super({
            ...options, // –ø–µ—Ä–µ–¥–∞—î–º–æ –≤—Å—ñ –æ–ø—Ü—ñ—ó –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–æ–º—É –∫–ª–∞—Å—É
            // —á–µ—Ä–≤–æ–Ω–∏–π –∫–æ–ª—ñ—Ä –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º
            color: options.color || red,
            // –≤–æ—Ä–æ–≥ —Ä—É—Ö–∞—î—Ç—å—Å—è –ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ –∑–∞ –≥—Ä–∞–≤—Ü—è
            speed: options.speed || 1,
            // –ø–æ—á–∞—Ç–∫–æ–≤–∏–π –Ω–∞–ø—Ä—è–º–æ–∫ –¥—É–ª–∞ –≤–Ω–∏–∑
            direction: options.direction || 'down'
        }, logger);
        
        // –∑–∞–ø–∏—Å—É—î–º–æ –≤ –ª–æ–≥
        this.logger.enemyAction('–í–æ—Ä–æ–≥ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π', `–ø–æ–∑–∏—Ü—ñ—è: (${this.x}, ${this.y})`);
    }
    
    /**
     * –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞–Ω—É –≤–æ—Ä–æ–≥–∞
     * @param {number} deltaTime - –ß–∞—Å –∑ –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
     */
    update(deltaTime) {
        // –ü–æ–∫–∏ —â–æ –ø—Ä–æ—Å—Ç–æ –æ–Ω–æ–≤–ª—é—î–º–æ —á–∞—Å
        // –í –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö —É—Ä–æ–∫–∞—Ö —Ç—É—Ç –±—É–¥–µ —à—Ç—É—á–Ω–∏–π —ñ–Ω—Ç–µ–ª–µ–∫—Ç –≤–æ—Ä–æ–≥–∞
    }
    
    /**
     * –ú–∞–ª—é–≤–∞–Ω–Ω—è –≤–æ—Ä–æ–≥–∞ –Ω–∞ –µ–∫—Ä–∞–Ω—ñ
     * @param {CanvasRenderingContext2D} ctx - –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –º–∞–ª—é–≤–∞–Ω–Ω—è
     */
    render(ctx) {
        // —è–∫—â–æ –≤–æ—Ä–æ–≥ –º–µ—Ä—Ç–≤–∏–π, –Ω–µ –º–∞–ª—é—î–º–æ
        if (!this.isAlive) return;
        
        // –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –ø–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
        ctx.save();
        
        // –≤–∏–∫–ª–∏–∫–∞—î–º–æ –º–µ—Ç–æ–¥ render –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–æ–≥–æ –∫–ª–∞—Å—É
        super.render(ctx);
        
        // –º–∞–ª—é—î–º–æ —á–µ—Ä–≤–æ–Ω–∏–π —Ö—Ä–µ—Å—Ç–∏–∫
        this.drawEnemyMark(ctx);
        
        // –≤—ñ–¥–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞–Ω –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
        ctx.restore();
    }
    
    /**
     * –ú–∞–ª—é–≤–∞–Ω–Ω—è –ø–æ–∑–Ω–∞—á–∫–∏ –≤–æ—Ä–æ–≥–∞ (—á–µ—Ä–≤–æ–Ω–∏–π —Ö—Ä–µ—Å—Ç–∏–∫)
     * @param {CanvasRenderingContext2D} ctx - –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –º–∞–ª—é–≤–∞–Ω–Ω—è
     */
    drawEnemyMark(ctx) {
        // —Ä–æ–∑–º—ñ—Ä –ø–æ–∑–Ω–∞—á–∫–∏ –≤ –ø—ñ–∫—Å–µ–ª—è—Ö
        const markSize = 6;
        // —Ü–µ–Ω—Ç—Ä —Ç–∞–Ω–∫–∞ –ø–æ X
        const centerX = this.x + this.width / 2;
        // —Ü–µ–Ω—Ç—Ä —Ç–∞–Ω–∫–∞ –ø–æ Y
        const centerY = this.y + this.height / 2;
        
        // —Ç–µ–º–Ω–æ-—á–µ—Ä–≤–æ–Ω–∏–π –∫–æ–ª—ñ—Ä –¥–ª—è –ª—ñ–Ω—ñ–π
        ctx.strokeStyle = darkGray;
        // —Ç–æ–≤—â–∏–Ω–∞ –ª—ñ–Ω—ñ–π —Ö—Ä–µ—Å—Ç–∏–∫–∞
        ctx.lineWidth = 2;
        
        // –ø–æ—á–∏–Ω–∞—î–º–æ –º–∞–ª—é–≤–∞—Ç–∏ —à–ª—è—Ö
        ctx.beginPath();
        // –ø–æ—á–∞—Ç–∫–æ–≤–∞ —Ç–æ—á–∫–∞
        ctx.moveTo(centerX - markSize, centerY - markSize);
        // –∫—ñ–Ω—Ü–µ–≤–∞ —Ç–æ—á–∫–∞
        ctx.lineTo(centerX + markSize, centerY + markSize);
        // –º–∞–ª—é—î–º–æ –ª—ñ–Ω—ñ—é
        ctx.stroke();
        
        // –ø–æ—á–∏–Ω–∞—î–º–æ –º–∞–ª—é–≤–∞—Ç–∏ –Ω–æ–≤–∏–π —à–ª—è—Ö
        ctx.beginPath();
        // –ø–æ—á–∞—Ç–∫–æ–≤–∞ —Ç–æ—á–∫–∞
        ctx.moveTo(centerX + markSize, centerY - markSize);
        // –∫—ñ–Ω—Ü–µ–≤–∞ —Ç–æ—á–∫–∞
        ctx.lineTo(centerX - markSize, centerY + markSize);
        // –º–∞–ª—é—î–º–æ –ª—ñ–Ω—ñ—é
        ctx.stroke();
    }
}
```

## üéØ –©–æ —Ä–æ–±–∏—Ç—å —Ü–µ–π –∫–ª–∞—Å?

### –£—Å–ø–∞–¥–∫—É–≤–∞–Ω–Ω—è –≤—ñ–¥ Tank:
- **–ù–∞—Å–ª—ñ–¥—É—î –≤—Å—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ** –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—É —Ç–∞–Ω–∫–∞
- **–ü–µ—Ä–µ–≤–∏–∑–Ω–∞—á–∞—î –¥–µ—è–∫—ñ –º–µ—Ç–æ–¥–∏** –¥–ª—è —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–æ—ó –ø–æ–≤–µ–¥—ñ–Ω–∫–∏ –≤–æ—Ä–æ–≥–∞

### –°–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ –≤–æ—Ä–æ–≥–∞:
- **–ö–æ–ª—ñ—Ä**: —á–µ—Ä–≤–æ–Ω–∏–π (`#e74c3c`) –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º
- **–®–≤–∏–¥–∫—ñ—Å—Ç—å**: 1 (–ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ –∑–∞ –≥—Ä–∞–≤—Ü—è)
- **–ù–∞–ø—Ä—è–º–æ–∫**: –≤–Ω–∏–∑ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º

### –î–æ–¥–∞—Ç–∫–æ–≤—ñ –º–µ—Ç–æ–¥–∏:
- **`drawEnemyMark(ctx)`** - –º–∞–ª—é—î —á–µ—Ä–≤–æ–Ω–∏–π —Ö—Ä–µ—Å—Ç–∏–∫ –≤ —Ü–µ–Ω—Ç—Ä—ñ —Ç–∞–Ω–∫–∞ –¥–ª—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –≤–æ—Ä–æ–≥–∞

### –õ–æ–≥—É–≤–∞–Ω–Ω—è:
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è** —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–æ—Ä–æ–≥–∞ –∑ –ø–æ–∑–∏—Ü—ñ—î—é
- **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `logger.enemyAction()`** –¥–ª—è –∑–∞–ø–∏—Å—É –¥—ñ–π –≤–æ—Ä–æ–≥–∞

## üé® –û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ –º–∞–ª—é–≤–∞–Ω–Ω—è

### –ü–æ–∑–Ω–∞—á–∫–∞ –≤–æ—Ä–æ–≥–∞:
- **–ß–µ—Ä–≤–æ–Ω–∏–π —Ö—Ä–µ—Å—Ç–∏–∫** –≤ —Ü–µ–Ω—Ç—Ä—ñ —Ç–∞–Ω–∫–∞
- **–†–æ–∑–º—ñ—Ä**: 6 –ø—ñ–∫—Å–µ–ª—ñ–≤
- **–ö–æ–ª—ñ—Ä**: —Ç–µ–º–Ω–æ-—á–µ—Ä–≤–æ–Ω–∏–π (`#c0392b`)
- **–¢–æ–≤—â–∏–Ω–∞ –ª—ñ–Ω—ñ–π**: 2 –ø—ñ–∫—Å–µ–ª—ñ

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–µ—Å—Ç–∏–∫–∞:
1. **–ü–µ—Ä—à–∞ –¥—ñ–∞–≥–æ–Ω–∞–ª—å**: –≤—ñ–¥ –≤–µ—Ä—Ö–Ω—å–æ–≥–æ –ª—ñ–≤–æ–≥–æ –¥–æ –Ω–∏–∂–Ω—å–æ–≥–æ –ø—Ä–∞–≤–æ–≥–æ –∫—É—Ç–∞
2. **–î—Ä—É–≥–∞ –¥—ñ–∞–≥–æ–Ω–∞–ª—å**: –≤—ñ–¥ –≤–µ—Ä—Ö–Ω—å–æ–≥–æ –ø—Ä–∞–≤–æ–≥–æ –¥–æ –Ω–∏–∂–Ω—å–æ–≥–æ –ª—ñ–≤–æ–≥–æ –∫—É—Ç–∞

### –ü–æ—Ä—è–¥–æ–∫ –º–∞–ª—é–≤–∞–Ω–Ω—è:
1. **–ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É** (`ctx.save()`)
2. **–ú–∞–ª—é–≤–∞–Ω–Ω—è –±–∞–∑–æ–≤–æ–≥–æ —Ç–∞–Ω–∫–∞** (`super.render(ctx)`)
3. **–ú–∞–ª—é–≤–∞–Ω–Ω—è –ø–æ–∑–Ω–∞—á–∫–∏ –≤–æ—Ä–æ–≥–∞** (`drawEnemyMark(ctx)`)
4. **–í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É** (`ctx.restore()`)

## üîÑ –í—ñ–¥–º—ñ–Ω–Ω–æ—Å—Ç—ñ –≤—ñ–¥ –≥—Ä–∞–≤—Ü—è

| –í–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å | –ì—Ä–∞–≤–µ—Ü—å üéÆ | –í–æ—Ä–æ–≥ üëπ |
|-------------|---------|-------|
| **–ö–æ–ª—ñ—Ä** | –ñ–æ–≤—Ç–∏–π (`#f1c40f`) | –ß–µ—Ä–≤–æ–Ω–∏–π (`#e74c3c`) |
| **–®–≤–∏–¥–∫—ñ—Å—Ç—å** | 2 | 1 |
| **–ü–æ–∑–Ω–∞—á–∫–∞** | –ñ–æ–≤—Ç–∏–π –∫—Ä—É–≥ | –ß–µ—Ä–≤–æ–Ω–∏–π —Ö—Ä–µ—Å—Ç–∏–∫ |
| **–ù–∞–ø—Ä—è–º–æ–∫** | –í–≥–æ—Ä—É | –í–Ω–∏–∑ |
| **–õ–æ–≥—É–≤–∞–Ω–Ω—è** | `playerAction()` | `enemyAction()` |

## üéÆ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

```javascript
// –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–æ—Ä–æ–≥–∞ –∑ –ª–æ–≥–≥–µ—Ä–æ–º
const enemy = new Enemy({
    x: 300,           // –ø–æ–∑–∏—Ü—ñ—è X
    y: 200,           // –ø–æ–∑–∏—Ü—ñ—è Y
    color: '#e74c3c', // —á–µ—Ä–≤–æ–Ω–∏–π –∫–æ–ª—ñ—Ä
    size: 32          // —Ä–æ–∑–º—ñ—Ä —Ç–∞–Ω–∫–∞
}, logger); // –ø–µ—Ä–µ–¥–∞—î–º–æ –ª–æ–≥–≥–µ—Ä –¥–ª—è –∑–∞–ø–∏—Å—É –ø–æ–¥—ñ–π

// –ú–∞–ª—é–≤–∞–Ω–Ω—è –≤–æ—Ä–æ–≥–∞
enemy.render(ctx);
```

## üìù –ü–∞—Ä–∞–º–µ—Ç—Ä logger

**`logger`** - —Ü–µ –æ–±'—î–∫—Ç —Å–∏—Å—Ç–µ–º–∏ –ª–æ–≥—É–≤–∞–Ω–Ω—è, —è–∫–∏–π –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –¥–ª—è –∑–∞–ø–∏—Å—É –ø–æ–¥—ñ–π –≤–æ—Ä–æ–≥–∞:

- **–¢–∏–ø**: `GameLogger` –∞–±–æ `null`
- **–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –ó–∞–ø–∏—Å –ø–æ–¥—ñ–π, –¥—ñ–π —Ç–∞ —Å—Ç–∞–Ω—É –≤–æ—Ä–æ–≥–∞
- **–ú–µ—Ç–æ–¥–∏**:
  - `enemyAction(message, details)` - –∑–∞–ø–∏—Å –¥—ñ–π –≤–æ—Ä–æ–≥–∞
  - `gameEvent(message, details)` - –∑–∞–ø–∏—Å —ñ–≥—Ä–æ–≤–∏—Ö –ø–æ–¥—ñ–π
  - `info(message, details)` - —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
  - `warning(message, details)` - –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è
  - `error(message, details)` - –ø–æ–º–∏–ª–∫–∏

**–ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è**:
```javascript
// –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ª–æ–≥–≥–µ—Ä–∞
const logger = new GameLogger();

// –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–æ—Ä–æ–≥–∞ –∑ –ª–æ–≥–≥–µ—Ä–æ–º
const enemy = new Enemy({
    x: 300,
    y: 200
}, logger);

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–æ—Ä–æ–≥–∞
// logger.enemyAction('–í–æ—Ä–æ–≥ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π', '–ø–æ–∑–∏—Ü—ñ—è: (300, 200)')
```

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ü—å–æ–≥–æ –∫–ª–∞—Å—É —É —Ç–µ–±–µ –±—É–¥–µ:
- ‚úÖ –ö–ª–∞—Å –≤–æ—Ä–æ–≥–∞ –∑ —á–µ—Ä–≤–æ–Ω–∏–º –∫–æ–ª—å–æ—Ä–æ–º
- ‚úÖ –ü–æ–∑–Ω–∞—á–∫–∞ –≤–æ—Ä–æ–≥–∞ (—á–µ—Ä–≤–æ–Ω–∏–π —Ö—Ä–µ—Å—Ç–∏–∫)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –¥—ñ–π
- ‚úÖ –ì–æ—Ç–æ–≤–Ω—ñ—Å—Ç—å –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è —à—Ç—É—á–Ω–æ–≥–æ —ñ–Ω—Ç–µ–ª–µ–∫—Ç—É

## üöÄ –©–æ –¥–∞–ª—ñ?

–£ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É —É—Ä–æ—Ü—ñ –º–∏ —Å—Ç–≤–æ—Ä–∏–º–æ –∫–ª–∞—Å —ñ–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è, —è–∫–∏–π –±—É–¥–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –∑–∞ –º–∞–ª—é–≤–∞–Ω–Ω—è —Å—ñ—Ç–∫–∏ —Ç–∞ —Ñ–æ–Ω—É.

**–¢–∏ –º–æ–ª–æ–¥–µ—Ü—å! üåü –ü—Ä–æ–¥–æ–≤–∂—É–π –≤ —Ç–æ–º—É –∂ –¥—É—Å—ñ!** 